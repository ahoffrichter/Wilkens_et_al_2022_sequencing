"0","# Function for calculating the fold changes from the GeneRatio/BgRatio values from the output of enrichGO"
"0",""
"0","kk2foldchange <- function(kk){"
"0","  GO <- as.data.frame(kk)"
"0","  GeneRatio <- strsplit(GO$GeneRatio,""/"")"
"0","  GRdf <- data.frame()"
"0","  for (i in seq_along(GeneRatio)){"
"0","    GRdf[i,1] <- GeneRatio[[i]][1]"
"0","    GRdf[i,2] <- GeneRatio[[i]][2]"
"0","  }"
"0","  GRdf$V1 <- as.numeric(GRdf$V1)"
"0","  GRdf$V2 <- as.numeric(GRdf$V2)"
"0","  GO$GeneRatio2 <- GRdf$V1/GRdf$V2"
"0","  BgRatio <- strsplit(GO$BgRatio,""/"")"
"0","  BgRdf <- data.frame()"
"0","  for (i in seq_along(BgRatio)){"
"0","    BgRdf[i,1] <- BgRatio[[i]][1]"
"0","    BgRdf[i,2] <- BgRatio[[i]][2]"
"0","  }"
"0","  BgRdf$V1 <- as.numeric(BgRdf$V1)"
"0","  BgRdf$V2 <- as.numeric(BgRdf$V2)"
"0","  GO$BgRatio2 <- BgRdf$V1/BgRdf$V2"
"0","  GO$foldchange <- GO$GeneRatio2/GO$BgRatio2"
"0","  return(GO)"
"0","}"
