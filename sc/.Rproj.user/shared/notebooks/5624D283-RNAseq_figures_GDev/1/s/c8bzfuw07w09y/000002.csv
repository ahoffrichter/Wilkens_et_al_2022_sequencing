"0","my_zscale <- function(x){"
"0","  M <- rowMeans(x, na.rm = TRUE)"
"0","  nsamples <- ncol(x)"
"0","  DF <- nsamples - 1L"
"0","  IsNA <- is.na(x)"
"0","  if (any(IsNA)) {"
"0","    mode(IsNA) <- ""integer"""
"0","    DF <- DF - rowSums(IsNA)"
"0","    DF[DF == 0L] <- 1L"
"0","  }"
"0","  x <- x - M"
"0","  V <- rowSums(x^2L, na.rm = TRUE)/DF"
"0","  x <- x/sqrt(V + 0.01)"
"0","  out <- melt(x)"
"0","  out"
"0","}"
